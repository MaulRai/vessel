name: Discord Push Notification

on:
  push:
    branches:
      - '**'  # Trigger on push to any branch

jobs:
  notify:
    runs-on: ubuntu-latest
    steps:
      - name: Send Discord Notification
        env:
          DISCORD_WEBHOOK: ${{ secrets.DISCORD_WEBHOOK }}
        run: |
          COMMIT_MESSAGE=$(echo "${{ github.event.head_commit.message }}" | head -n 1)
          BRANCH_NAME="${{ github.ref_name }}"
          AUTHOR_NAME="${{ github.event.head_commit.author.name }}"
          COMMIT_URL="${{ github.event.head_commit.url }}"
          REPO_NAME="${{ github.repository }}"
          
          curl -H "Content-Type: application/json" \
            -d "{
              \"embeds\": [{
                \"title\": \"ðŸ“¦ New Push to \`$BRANCH_NAME\`\",
                \"description\": \"**$COMMIT_MESSAGE**\",
                \"color\": 5814783,
                \"fields\": [
                  {
                    \"name\": \"Repository\",
                    \"value\": \"[$REPO_NAME](https://github.com/$REPO_NAME)\",
                    \"inline\": true
                  },
                  {
                    \"name\": \"Branch\",
                    \"value\": \"\`$BRANCH_NAME\`\",
                    \"inline\": true
                  },
                  {
                    \"name\": \"Author\",
                    \"value\": \"$AUTHOR_NAME\",
                    \"inline\": true
                  },
                  {
                    \"name\": \"Commit\",
                    \"value\": \"[View Changes]($COMMIT_URL)\",
                    \"inline\": false
                  }
                ],
                \"timestamp\": \"${{ github.event.head_commit.timestamp }}\"
              }]
            }" \
            $DISCORD_WEBHOOK
